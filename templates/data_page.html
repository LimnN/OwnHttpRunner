{% extends "base.html" %}
{% block title %}data generate{% endblock %}
{% load staticfiles %}
{% load custom_tags %}
{% block content %}

    <div class="admin-biaogelist">
        <form class="am-form am-g" id='suite_list' name="suite_list">
            <table width="100%" class="am-table am-table-bordered am-table-radius am-table-striped">
                <thead>
                    <tr class="am-success">
                        <th class="table-title">选择fe-api环境</th>
                        <th class="table-type">选择gateway环境</th>
                        <th class="table-type">选择设备类型</th>
                        <th class="table-type">True or False</th>
                        <th width="163px" class="table-title">操作</th>
                    </tr>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <select class="selectpicker fe" name="fe_env">
                           {% for e in env %}
                           <option value="{{ e }}">{{ e.name }}</option>
                           {% endfor %}
                        </select>
                    </td>
                    <td>
                        <select class="selectpicker gateway" name="gateway_env">
                            {% for e in env %}
                            <option value="{{ e }}">{{ e.name }}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td>
                        <select multiple class="selectpicker devices" data-live-search="true" data-actions-box="true" title="选择设备类型" name="devices">
                            {% for device in devices %}
                            <option value="{{ device }}">{{ device }}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td>
                        <select class="selectpicker isopen" name="isopen">
                            <option value="False">False</option>
                            <option value="True">True</option>
                        </select>
                    </td>
                    <td>
                        <div class="am-btn-toolbar">
                            <div class="am-btn-group am-btn-group-xs">
                                <button type="button"
                                        class="am-btn am-btn-default am-btn-xs am-text-secondary am-round"
                                        data-am-popover="{content: '执行', trigger: 'hover focus'}"
                                        onclick="start_gen()">
                                    <span class="am-icon-bug"></span>
                                </button>

                            </div>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>

        </form>
    </div>
    <script type="text/javascript">
        

        function start_gen(fe, gateway, devices, isopen) {
            var fe = $('.selectpicker.fe').val()
            var gateway = $('.selectpicker.gateway').val()
            var devices = $('.selectpicker.devices').val()
            var isopen = $('.selectpicker.isopen').val()
            if (devices === null) {
                alert('please select device type ')
            }
            else {
                var data = {
                    "fe_env": fe,
                    "gateway": gateway,
                    "devices": devices,
                    "isopen": isopen
                }
                $.ajax(
                    {
                        type: 'post',
                        url: '/api/status_send/',
                        data: JSON.stringify(data),
                        contentType: "application/json",
                        success: function(data) {
                            alert('success' + data);
                        },
                        error: function () {
                            alert('error')
                        }
                    }
                )
            }
        }
    </script>
{% endblock %}